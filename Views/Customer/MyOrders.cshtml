@model ICollection<GqeberhaPharmacy.Models.PrescriptionOrder>

@{
    Layout = "_Layout";
    ViewData["Title"] = "My Orders";
}

@section Sidebar {
    <h5 class="mb-4">Customer Menu</h5>
    <a href="/Customer/Index"><i class="fas fa-home"></i> Dashboard</a>
    <a href="/Customer/MyOrders" class="active"><i class="fas fa-shopping-bag"></i> My Orders</a>
    <a href="/Customer/UploadPrescription"><i class="fas fa-upload"></i> Upload Prescription</a>
}

<div class="container">
    <h1><i class="fas fa-shopping-bag"></i> My Orders</h1>
    <hr>

    <div class="table-responsive">
        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th>Order ID</th>
                    <th>Order Date</th>
                    <th>Items</th>
                    <th>Status</th>
                    <th>Amount Due</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Count == 0)
                {
                    <tr>
                        <td colspan="6" class="text-center">You haven't placed any orders yet</td>
                    </tr>
                }
                else
                {
                    @foreach (var order in Model)
                    {
                        <tr>
                            <td><strong>@order.Id.Substring(0, 8)</strong></td>
                            <td>@order.OrderDate.ToString("dd/MM/yyyy")</td>
                            <td>@order.Prescription?.Items.Count ?? 0 items</td>
                            <td>
                                @if (order.Status == 0)
                                {
                                    <span class="badge bg-warning">Pending</span>
                                }
                                else if (order.Status == 1)
                                {
                                    <span class="badge bg-info">Ready</span>
                                }
                                else if (order.Status == 2)
                                {
                                    <span class="badge bg-success">Collected</span>
                                }
                            </td>
                            <td>
                                @if (order.AmountDue.HasValue)
                                {
                                    <strong>R@order.AmountDue.Value.ToString("F2")</strong>
                                }
                                else
                                {
                                    <span class="text-muted">-</span>
                                }
                            </td>
                            <td>
                                <a href="/Customer/OrderDetail/@order.Id" class="btn btn-sm btn-outline-primary">View</a>
                            </td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>
</div>
